#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass article
\begin_preamble
\usepackage{tikz}
\usetikzlibrary{bayesnet}
\end_preamble
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Standard
We have the following probabilistic graphical model,
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
begin{center} 
\end_layout

\begin_layout Plain Layout


\backslash
begin{tikzpicture}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node[const] (alpha)	{$
\backslash
alpha$}; 
\end_layout

\begin_layout Plain Layout


\backslash
node[latent, right=1.2 of alpha] (pi) {$
\backslash
pi$}; 
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node[latent, right=1.2 of pi] (z) {$z_{n}$}; 
\end_layout

\begin_layout Plain Layout


\backslash
node[obs, right=1.2 of z]	(x) {$x_{n}$}; 
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node[latent, below=1.2 of x, xshift=-0.75cm] (muk) {$
\backslash
mu_{k}$}; 
\end_layout

\begin_layout Plain Layout


\backslash
node[const, below=of muk, xshift=-0.25cm]	(o)	{$m_o$}; 
\end_layout

\begin_layout Plain Layout


\backslash
node[const, below=of muk, xshift=0.25cm] (c) {$
\backslash
beta_o$}; 
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node[const] (alpha) {$
\backslash
alpha$}; 
\end_layout

\begin_layout Plain Layout


\backslash
node[latent, below=1.2 of x, xshift=0.75cm] (sigmak) {$
\backslash
Delta_{k}$}; 
\end_layout

\begin_layout Plain Layout


\backslash
node[const, below=of sigmak, xshift=-0.3cm] (a) {$
\backslash
nu_o$}; 
\end_layout

\begin_layout Plain Layout


\backslash
node[const, below=of sigmak, xshift=0.3cm]	(b)	{$W_o$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
edge {alpha} {pi}; 
\end_layout

\begin_layout Plain Layout


\backslash
edge {pi} {z}; 
\end_layout

\begin_layout Plain Layout


\backslash
edge {z} {x}; 
\end_layout

\begin_layout Plain Layout


\backslash
edge {muk} {x}; 
\end_layout

\begin_layout Plain Layout


\backslash
edge {sigmak} {x}; 
\end_layout

\begin_layout Plain Layout


\backslash
edge {o} {muk}; 
\end_layout

\begin_layout Plain Layout


\backslash
edge {c} {muk};
\end_layout

\begin_layout Plain Layout


\backslash
edge {sigmak} {muk};
\end_layout

\begin_layout Plain Layout


\backslash
edge {a} {sigmak}; 
\end_layout

\begin_layout Plain Layout


\backslash
edge {b} {sigmak};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
plate {pn} {(z)(x)} {$N$}; 
\end_layout

\begin_layout Plain Layout


\backslash
plate {pk} {(muk)(sigmak)} {$K$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
end{tikzpicture} 
\end_layout

\begin_layout Plain Layout


\backslash
end{center}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
whose joint probability distribution can be expressed as follows,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
p(\vec{x},\,\vec{z},\,\vec{\mu},\,\vec{\Delta}|\,\alpha,\,m_{o},\,\beta_{o},\,\nu_{o},\,W_{o})= & p(\pi|\alpha)\prod_{k=1}^{K}p(\mu_{k}|\,m_{o},\,(\beta_{o}\Delta_{k})^{-1})p(\Delta_{k}|\nu_{o},\,W_{o})\\
 & \prod_{n=1}^{N}p(x_{n}|\mu_{z_{n}},\,\Delta_{z_{n}}^{-1})
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
and the logarithm of the joint probability distribution as
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\log p(\vec{x},\,\vec{z},\,\vec{\mu},\,\vec{\Delta}|\,\alpha,\,m_{o},\,\beta_{o},\,\nu_{o},\,W_{o})= & \log p(\pi|\alpha)+\sum_{k=1}^{K}\log p(\mu_{k}|\,m_{o},\,(\beta_{o}\Delta_{k})^{-1})+\log p(\Delta_{k}|\nu_{o},\,W_{o})\\
 & +\sum_{n=1}^{N}\log p(x_{n}|\mu_{z_{n}},\,\Delta_{z_{n}}^{-1})
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
where, 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
p(\pi|\alpha)= & Dir(\alpha)\\
p(\mu_{k}|\,m_{o},\,(\beta_{o}\Delta_{k})^{-1})= & N(m_{o},\,(\beta_{o}\Delta_{k})^{-1})\\
p(\Delta_{k}|\nu_{o},W_{o})= & Wi(\nu_{o},\,W_{o})\\
p(x_{n}|\mu_{z_{n}},\Delta_{z_{n}}^{-1})= & N(\mu_{z_{n}},\,\Delta_{z_{n}}^{-1})
\end{align*}

\end_inset


\begin_inset Newline newline
\end_inset


\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Standard
We will consider the following mean-field approximation,
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{center} 
\end_layout

\begin_layout Plain Layout


\backslash
begin{tikzpicture}
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node[const] (lambda_pi)	{$
\backslash
lambda_{
\backslash
pi}$}; 
\end_layout

\begin_layout Plain Layout


\backslash
node[latent, right=1 of alpha] (pi) {$
\backslash
pi$}; 
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node[const, right=1 of pi] (phi) {$
\backslash
phi_{n}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[latent, right=1 of phi] (z) {$z_{n}$}; 
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node[latent, below=1 of z, xshift=-0.5cm] (muk) {$
\backslash
mu_{k}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[const, below=1 of muk] (lambda_mu) {$
\backslash
lambda_{
\backslash
mu}$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
node[latent, below=1 of z, xshift=0.5cm] (deltak){$
\backslash
Delta_{k}$};
\end_layout

\begin_layout Plain Layout


\backslash
node[const, below=1 of deltak] (lambda_delta) {$
\backslash
Delta_{k}$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
edge {lambda_pi} {pi}; 
\end_layout

\begin_layout Plain Layout


\backslash
edge {phi} {z}; 
\end_layout

\begin_layout Plain Layout


\backslash
edge {lambda_mu} {muk};
\end_layout

\begin_layout Plain Layout


\backslash
edge {lambda_delta} {deltak};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
plate {pn} {(z)(phi)} {$N$}; 
\end_layout

\begin_layout Plain Layout


\backslash
plate {pk} {(muk)(deltak)(lambda_mu)(lambda_delta)} {$K$};
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout


\backslash
end{tikzpicture} 
\end_layout

\begin_layout Plain Layout


\backslash
end{center}
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
whose probability distribution can be expressed as,
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
q(\pi,z,\mu,\Delta|\lambda_{\pi},\lambda_{\mu},\lambda_{\Delta})= & q(\pi|\lambda_{\pi})\prod_{n=1}^{N}q(z_{n}|\phi_{n})\prod_{k=1}^{K}q(\mu_{k}|\lambda_{\mu_{k}})q(\Delta_{k}|\lambda_{\Delta_{k}})
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
and the logarithm of the joint probability, 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
\log q(\pi,z,\mu,\Delta|\lambda_{\pi},\lambda_{\mu},\lambda_{\Delta})= & \log q(\pi|\lambda_{\pi})+\sum_{n=1}^{N}\log q(z_{n}|\phi_{n})+\sum_{k=1}^{K}\log q(\mu_{k}|\lambda_{\mu_{k}})+\log q(\Delta_{k}|\lambda_{\Delta_{k}})
\end{align*}

\end_inset


\end_layout

\end_body
\end_document
