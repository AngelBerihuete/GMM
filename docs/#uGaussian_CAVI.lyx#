#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass article
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Section*
Univariate Gaussian joint probability
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
P(\textbf{x},\mu,\gamma) & =\mathbb{\mathcal{N}}(\mu|m,\beta^{-1})Ga(\gamma|a,b)\prod_{n=1}^{N}\mathbb{\mathcal{N}}(x_{n}|\mu,\gamma^{-1})
\end{align*}

\end_inset


\end_layout

\begin_layout Section*
Variational Distribution
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
q(\mu,\gamma) & =q_{\mu}(\mu)q_{\gamma}(\gamma)
\end{align*}

\end_inset


\end_layout

\begin_layout Section*
Coordiante Ascent Variational Inference (CAVI)
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
q(\mu|\mu') & \propto\exp(\mathbb{\mathbb{E}}_{q(\gamma|\gamma')}[\log P(\textbf{x},\mu,\gamma)])\\
q(\gamma|\gamma') & \propto\exp(\mathbb{E}_{q(\mu|\mu')}[\log P(\textbf{x},\mu,\gamma)])
\end{align*}

\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\begin_layout Subsection*
Mean 
\begin_inset Formula $q(\mu|\mu')$
\end_inset

 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
q(\mu|\mu') & \propto\exp\left(\mathbb{\mathbb{E}}_{q(\gamma|\gamma')}\left[\log P(\textbf{x},\mu,\gamma)\right]\right)\\
 & \propto\exp\left(\mathbb{\mathbb{E}}_{q(\gamma|\gamma')}\left[\log\mathbb{\mathcal{N}}(\mu|m,\beta^{-1})+\log Ga(\gamma|a,b)+\sum_{n=1}^{N}\log\mathbb{\mathcal{N}}(x_{n}|\mu,\gamma^{-1})\right]\right)\\
 & \propto\exp\left(\log\mathbb{\mathcal{N}}(\mu|m,\beta^{-1})+\sum_{n=1}^{N}\mathbb{\mathbb{E}}_{q(\gamma|\gamma')}\left[\log\mathbb{\mathcal{N}}(x_{n}|\mu,\gamma^{-1})\right]\right)\\
 & \propto\exp\left(\frac{1}{2}\log\beta-\frac{1}{2}\beta\left(\mu-m\right)^{2}+\sum_{n=1}^{N}\mathbb{\mathbb{E}}_{q(\gamma|\gamma')}\left[\frac{1}{2}\log\gamma-\frac{1}{2}\gamma\left(x_{n}-\mu\right)^{2}\right]\right)\\
 & \propto\exp\left(\frac{1}{2}\log\beta-\frac{1}{2}\beta\left(\mu^{2}-2m\mu+m^{2}\right)+\frac{N}{2}\mathbb{E}_{q(\gamma|\gamma')}\left[\log\gamma\right]-\frac{1}{2}\mathbb{E}_{q(\gamma|\gamma')}\left[\gamma\right]\sum_{n=1}^{N}\left(x_{n}^{2}-2x_{n}\mu+\mu^{2}\right)\right)\\
 & \propto\exp\left(-\frac{1}{2}\beta\left(\mu^{2}-2m\mu+m^{2}\right)-\frac{1}{2}\mathbb{E}_{q(\gamma|\gamma')}\left[\gamma\right]\sum_{n=1}^{N}\left(x_{n}^{2}-2x_{n}\mu+\mu^{2}\right)\right)\\
 & \propto\exp\left(-\frac{1}{2}\mu^{2}\left(\beta+N\mathbb{E}_{q(\gamma|\gamma')}\left[\gamma\right]\right)+\mu\left(\beta m+\mathbb{E}_{q(\gamma|\gamma')}\left[\gamma\right]\sum_{n=1}^{N}x_{n}\right)\right)\\
q(\mu|m_{\mu,}\beta_{\mu}) & =\mathbb{\mathcal{N}}\left(\mu|m_{u}=\frac{\beta m+\mathbb{E}_{q(\gamma|\gamma')}\left[\gamma\right]\sum_{n=1}^{N}x_{n}}{\beta+N\mathbb{E}_{q(\gamma|\gamma')}\left[\gamma\right]},\beta_{\mu}=\beta+N\mathbb{E}_{q(\gamma|\gamma')}\left[\gamma\right]\right)
\end{align*}

\end_inset


\end_layout

\begin_layout Subsection*
Precision 
\begin_inset Formula $q(\gamma|\gamma')$
\end_inset


\end_layout

\begin_layout Subsection*
\begin_inset Formula 
\begin{align*}
q(\gamma|\gamma') & \propto\exp\left(\mathbb{E}_{q(\mu|\mu')}\left[\log P(\textbf{x},\mu,\gamma)\right]\right)\\
 & \propto\exp\left(\mathbb{\mathbb{E}}_{q(\mu|\mu')}\left[\log\mathbb{\mathcal{N}}(\mu|m,\beta^{-1})+\log Ga(\gamma|a,b)+\sum_{n=1}^{N}\log\mathbb{\mathcal{N}}(x_{n}|\mu,\gamma^{-1})\right]\right)\\
 & \propto\exp\left(\log Ga(\gamma|a,b)+\sum_{n=1}^{N}\mathbb{\mathbb{E}}_{q(\mu|\mu')}\left[\log\mathbb{\mathcal{N}}(x_{n}|\mu,\gamma^{-1})\right]\right)\\
 & \propto\exp\left((a-1)\log\gamma-b\gamma+\sum_{n=1}^{N}\frac{1}{2}\log\gamma-\frac{1}{2}\gamma\mathbb{\mathbb{E}}_{q(\mu|\mu')}\left[\left(x_{n}-\mu\right)^{2}\right]\right)\\
 & \propto\exp\left((a-1+\frac{N}{2})\log\gamma-\left(b+\frac{1}{2}\sum_{n=1}^{N}\mathbb{\mathbb{E}}_{q(\mu|\mu')}\left[\left(x_{n}-\mu\right)^{2}\right]\right)\gamma\right)\\
q(\gamma|\gamma') & =Ga\left(\gamma|a_{\gamma}=a+\frac{N}{2},b_{\gamma}=b+\frac{1}{2}\sum_{n=1}^{N}x_{n}^{2}-2x_{n}\mathbb{\mathbb{E}}_{q(\mu|\mu')}\left[\mu\right]+\mathbb{\mathbb{E}}_{q(\mu|\mu')}\left[\mu^{2}\right]\right)
\end{align*}

\end_inset


\begin_inset Newline newline
\end_inset

LowerBound
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{align*}
ELBO(x,\mu',\gamma')= & \mathbb{E}_{q}\left[\log P(\textbf{x},\mu,\gamma)\right]-\mathbb{E}_{q}\left[\log q(\mu,\gamma)\right]\\
= & \mathbb{\mathbb{E}}_{q(\mu|\mu')}\left[\log\mathbb{\mathcal{N}}(\mu|m,\beta^{-1})\right]+\mathbb{E}_{q(\gamma|\gamma')}\left[\log Ga(\gamma|a,b)\right]+\sum_{n=1}^{N}\mathbb{E}_{q}\left[\log\mathbb{\mathcal{N}}(x_{n}|\mu,\gamma^{-1})\right]\\
 & -\mathbb{\mathbb{E}}_{q(\mu|\mu')}\left[\log\mathbb{\mathcal{N}}(\mu|m_{\mu},\beta_{\mu})\right]-\mathbb{E}_{q(\gamma|\gamma')}\left[\log Ga(\gamma|a_{\gamma},b_{\gamma})\right]\\
= & \frac{1}{2}\log\beta-\frac{1}{2}\log2\pi-\frac{1}{2}\beta\left(\mathbb{\mathbb{E}}_{q(\mu|\mu')}\left[\mu^{2}\right]-2m\mathbb{\mathbb{E}}_{q(\mu|\mu')}\left[\mu\right]+m^{2}\right)\\
 & +a\log b-\log\Gamma(a)+(a-1)\mathbb{E}_{q(\gamma|\gamma')}\left[\log\gamma\right]-b\mathbb{E}_{q(\gamma|\gamma')}\left[\gamma\right]\\
 & +\sum_{n=1}^{N}\frac{1}{2}\mathbb{E}_{q(\gamma|\gamma')}\left[\log\gamma\right]-\frac{1}{2}\log2\pi-\frac{1}{2}\mathbb{E}_{q(\gamma|\gamma')}\left[\gamma\right]\left(x_{n}^{2}-2x_{n}\mathbb{\mathbb{E}}_{q(\mu|\mu')}\left[\mu\right]+\mathbb{\mathbb{E}}_{q(\mu|\mu')}\left[\mu^{2}\right]\right)\\
 & -\frac{1}{2}\log\beta_{\mu}+\frac{1}{2}\log2\pi+\frac{1}{2}\beta_{\mu}\left(\mathbb{\mathbb{E}}_{q(\mu|\mu')}\left[\mu^{2}\right]-2m_{\mu}\mathbb{\mathbb{E}}_{q(\mu|\mu')}\left[\mu\right]+m_{\mu}^{2}\right)\\
 & -a_{\gamma}\log b_{\gamma}+\log\Gamma(a_{\gamma})-(a_{\gamma}-1)\mathbb{E}_{q(\gamma|\gamma')}\left[\log\gamma\right]+b_{\gamma}\mathbb{E}_{q(\gamma|\gamma')}\left[\gamma\right]\\
= & \frac{1}{2}\log\frac{\beta}{\beta_{\mu}}+\frac{1}{2}\mathbb{\mathbb{E}}_{q(\mu|\mu')}\left[\mu^{2}\right]\left(\beta_{\mu}-\beta\right)-\mathbb{\mathbb{E}}_{q(\mu|\mu')}\left[\mu\right]\left(\beta_{\mu}m_{\mu}-\beta m\right)+\frac{1}{2}\left(\beta_{\mu}m_{\mu}^{2}-\beta m^{2}\right)\\
 & +a\log b-a_{\gamma}\log b_{\gamma}+\log\frac{\Gamma(a_{\gamma})}{\Gamma(a)}+\mathbb{E}_{q(\gamma|\gamma')}\left[\log\gamma\right]\left(a-a_{\gamma}\right)+\mathbb{E}_{q(\gamma|\gamma')}\left[\gamma\right]\left(b_{\gamma}-b\right)\\
 & +\frac{N}{2}\mathbb{E}_{q(\gamma|\gamma')}\left[\log\gamma\right]-\frac{N}{2}\log2\pi-\frac{1}{2}\mathbb{E}_{q(\gamma|\gamma')}\left[\gamma\right]\sum_{n=1}^{N}\left(x_{n}^{2}-2x_{n}\mathbb{\mathbb{E}}_{q(\mu|\mu')}\left[\mu\right]+\mathbb{\mathbb{E}}_{q(\mu|\mu')}\left[\mu^{2}\right]\right)
\end{align*}

\end_inset


\begin_inset Newline newline
\end_inset


\end_layout

\end_body
\end_document
